---
interface Props {
  title?: string;
  description?: string;
  compact?: boolean;
}

const {
  title = "Únete a la tripulación",
  description = "Suscríbete para recibir noticias, fechas de conciertos y contenido exclusivo.",
  compact = false,
} = Astro.props;

// Mailchimp form action URL
const mailchimpUrl = "https://gmail.us2.list-manage.com/subscribe/post";
const mailchimpU = "e65f0969bdae89ce6a523cdc2";
const mailchimpId = "dcd925529c";
---

<div class={compact ? "" : "bg-band-dark-100 border border-band-sea/20 rounded-lg p-6 md:p-8"}>
  {!compact && (
    <div class="text-center mb-6">
      <h3 class="text-xl md:text-2xl font-metal text-band-sea mb-2">
        {title}
      </h3>
      <p class="text-gray-400 text-sm">
        {description}
      </p>
    </div>
  )}

  <form
    action={mailchimpUrl}
    method="post"
    id="mc-embedded-subscribe-form"
    name="mc-embedded-subscribe-form"
    class="validate"
    target="_blank"
    novalidate
  >
    <input type="hidden" name="u" value={mailchimpU} />
    <input type="hidden" name="id" value={mailchimpId} />

    <div class={compact ? "flex gap-2" : "flex flex-col sm:flex-row gap-3"}>
      <!-- Email input -->
      <div class="flex-1">
        <label for="mce-EMAIL" class="sr-only">Email</label>
        <input
          type="email"
          value=""
          name="EMAIL"
          id="mce-EMAIL"
          placeholder="tu@email.com"
          required
          class={`w-full px-4 py-3 bg-band-dark border border-band-sea/20 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-band-sea focus:ring-1 focus:ring-band-sea transition-colors ${compact ? "text-sm" : ""}`}
        />
      </div>

      <!-- Honeypot anti-spam -->
      <div style="position: absolute; left: -5000px;" aria-hidden="true">
        <input type="text" name="b_e65f0969bdae89ce6a523cdc2_dcd925529c" tabindex="-1" value="" />
      </div>

      <!-- Submit button -->
      <button
        type="submit"
        name="subscribe"
        id="mc-embedded-subscribe"
        class={`btn-primary whitespace-nowrap ${compact ? "px-4 py-2 text-sm" : ""}`}
      >
        {compact ? "Suscribir" : "Suscribirme"}
      </button>
    </div>

    <!-- Success/Error messages (handled by Mailchimp redirect) -->
    <p class="text-xs text-gray-400 mt-3 text-center">
      Al suscribirte aceptas recibir emails de Legacy of the Seas.
      Puedes darte de baja en cualquier momento.
    </p>
  </form>
</div>

<style>
  /* Hide Mailchimp branding if embedded */
  :global(#mce-responses) {
    display: none;
  }
</style>
